<?php if ( ! defined( 'DEVIL_SYS_CORE_PATH' ) ) exit( 'No direct script access allowed' );
/**
  @brief        Order Model ( 訂單管理模組 )
**/

class Order_Model extends Model
{
    /**
    @brief      建構子
    **/
    public function __construct()
    {
        parent::__construct();
    }

    /**
    @brief      取得所有商品
    @retval     Mix / FALSE
    **/
    public function getOrderdata( $_pages = 1, $srcArr = "", $_ps = 50 )
    {
        # ----------------------------------------------------------------------
        # 組合SQL語法
        # ----------------------------------------------------------------------
        $sql = "SELECT * FROM  `orderdata`" ;
        # ----------------------------------------------------------------------
        # 組合查詢條件
        # ----------------------------------------------------------------------
        if ( $srcArr )
        {
            $sql .= ' WHERE ' . implode( ' AND ',  $srcArr );
        }
        else
        {
            $sql .= ' WHERE 1';
        }
        # ----------------------------------------------------------------------
        # 執行查詢結果
        # ----------------------------------------------------------------------
        $result = Bootstart::$_lib['Core_Pdo_Driver']->pagination
        (
            DEVIL_APP_Url . 'Order/index/list/',
            $sql ,
            array( ) ,
            'ORDER BY `createtime` DESC' ,
            intval( $_pages ) ,
            $_ps
        );
        # ----------------------------------------------------------------------
        # 防呆判斷
        # ----------------------------------------------------------------------
        if ( ! $result )
        {
            return false;
        }
        else
        {
            # ------------------------------------------------------------------
            # 回傳資料集
            # ------------------------------------------------------------------
            return $result;
        }
    }

    /**
    @brief      取得所有商品
    @retval     Mix / FALSE
    **/
    public function getOrderById( $_id = 1 )
    {
        # ----------------------------------------------------------------------
        # 組合SQL語法
        # ----------------------------------------------------------------------
        $sql = "SELECT * FROM `orderdata` WHERE `id` = {$_id} ";
        # ----------------------------------------------------------------------
        # 執行查詢結果
        # ----------------------------------------------------------------------
        $result = $this->db->query( $sql );
        # ----------------------------------------------------------------------
        # 防呆判斷
        # ----------------------------------------------------------------------
        if ( ! $result )
        {
            return false;
        }
        else
        {
            # ------------------------------------------------------------------
            # 回傳資料集
            # ------------------------------------------------------------------
            return $result->fetch();
        }
    }
}